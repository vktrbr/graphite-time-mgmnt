schema: '2.0'
stages:
  get_data_from_dwh:
    cmd: "python src/data/get_raw_data_from_jira_api.py --output-path data/raw/raw_jira_tasks_from_api.json\n"
    deps:
    - path: data/raw/.private_params.json
      hash: md5
      md5: fdacb14c0a06ded10dd5fee4b1083b7d
      size: 166
    - path: src/.env
      hash: md5
      md5: a2fdc1ea184c4f61966156b76b88c7ea
      size: 1473
    outs:
    - path: data/raw/raw_jira_tasks_from_api.json
      hash: md5
      md5: 45fb71d2c2553bc28d259ed150dd75b5
      size: 2277016
  filter_jira_issues:
    cmd: "python src/data/filter_tasks_n_fields_jira_json.py --input-path data/raw/raw_jira_tasks_from_api.json
      --output-path data/interim/filtered_jira_tasks.json\n"
    deps:
    - path: data/raw/raw_jira_tasks_from_api.json
      hash: md5
      md5: 0cf1a4cfc72fda779d7c6329ad6ed701
      size: 2467644
    outs:
    - path: data/interim/filtered_jira_tasks.json
      hash: md5
      md5: 6b9c26605c71fa154d5eef7e74a7ef01
      size: 219411
  enrich_with_slack_conversations:
    cmd: python src/data/enrich_with_slack_thread.py --input-path data/interim/filtered_jira_tasks.json
      --output-path data/interim/enriched_jira_tasks.json
    deps:
    - path: data/interim/filtered_jira_tasks.json
      hash: md5
      md5: 6b9c26605c71fa154d5eef7e74a7ef01
      size: 219411
    outs:
    - path: data/interim/enriched_jira_tasks.json
      hash: md5
      md5: cb6fa5453abde6a5f9404d7eae9c86af
      size: 376473
  get_raw_data_from_jira_api:
    cmd: "python src/data/get_raw_data_from_jira_api.py --output-path data/raw/raw_jira_tasks_from_api.json\n"
    outs:
    - path: data/raw/raw_jira_tasks_from_api.json
      hash: md5
      md5: 0cf1a4cfc72fda779d7c6329ad6ed701
      size: 2467644
  remove_pii_from_enriched_data:
    cmd: python src/data/remove_pii_from_data.py --input-path data/interim/enriched_jira_tasks.json
      --output-path data/interim/cleaned_enriched_jira_tasks.json --pii-fields-to-remove
      jira_description,jira_title,slack_thread_messages
    deps:
    - path: data/interim/enriched_jira_tasks.json
      hash: md5
      md5: cb6fa5453abde6a5f9404d7eae9c86af
      size: 376473
    outs:
    - path: data/interim/cleaned_enriched_jira_tasks.json
      hash: md5
      md5: cb6fa5453abde6a5f9404d7eae9c86af
      size: 376473
  combine_text_info_into_one_task:
    cmd: python src/data/combine_text_info_into_one_task.py --input-path data/interim/cleaned_enriched_jira_tasks.json
      --output-path data/interim/combined_jira_tasks.json
    deps:
    - path: data/interim/cleaned_enriched_jira_tasks.json
      hash: md5
      md5: cb6fa5453abde6a5f9404d7eae9c86af
      size: 376473
    outs:
    - path: data/interim/combined_jira_tasks.json
      hash: md5
      md5: 2d2b6997d85fe141e772b45cc8d140f2
      size: 1132337
  get_final_data_to_train:
    cmd: python src/data/get_final_data_to_train.py --input-path data/interim/combined_jira_tasks.json
      --output-path data/processed/final_data_to_train.json
    deps:
    - path: data/interim/combined_jira_tasks.json
      hash: md5
      md5: 64cdc7f7009736b385e3ee7b4134ec23
      size: 1132339
    outs:
    - path: data/processed/final_data_to_train.json
      hash: md5
      md5: a7975ebf53d8cb784c6b95faf3d637f5
      size: 762691
